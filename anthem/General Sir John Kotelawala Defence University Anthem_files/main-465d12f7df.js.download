function hasParentClass(e,t){return e!==document&&(!!jQuery(e).hasClass(t)||e.parentNode&&hasParentClass(e.parentNode,t))}function getEventType(){return"ontouchstart"in window?"touchstart":"click"}window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")),jQuery.extend(jQuery.easing,{easeInOutQuad:function(e,t,n,i,o){return(t/=o/2)<1?i/2*t*t+n:-i/2*(--t*(t-2)-1)+n}});var eventtype=getEventType(),screenSizes={small:480,smallMedium:640,medium:768,subscription:810,large:1024,max:1140},scrollbarConfig={autoHideScrollbar:!0,mouseWheel:{preventDefault:!0},scrollInertia:25,documentTouchScroll:!1},pusherHammer=new Hammer.Manager(jQuery("body")[0],{touchAction:"auto",cssProps:{userSelect:!0},recognizers:[[Hammer.Swipe,{direction:Hammer.DIRECTION_VERTICAL}]]}),dynamicData=function(e){function t(e){return e?e.replace(window.location.origin,""):"/"}function n(t,n,i){var t=e.extend({url:window.to.ajaxUrl},t);return"function"==typeof n&&(t.success=n),"function"==typeof i&&(t.complete=i),e.ajax(t)}function i(){return{meta:c,url:s}}function o(e){var n=t(e.url);s||(s=!0),void 0!=window.dataLayer&&window.dataLayer.push({event:"VirtualPageview",virtualPageURL:n,virtualPageTitle:e.title})}function a(n,i){c&&(c=!0),e("html title").text(n.title),e('meta[property="og:title"]').attr("content",n.title),e('meta[name="twitter:title"]').attr("content",n.title),e('meta[property="og:url"]').attr("content",n.url),e('meta[property="og:type"]').attr("content","article");var o=t(n.url);return i?history.replaceState(null,n.title,o):history.pushState(null,n.title,o),e(window).trigger("meta:changed",[n.url,n.title]),n}function r(e,t){"url"==e?s=t:"meta"==e&&(c=t)}var s=!1,c=!1;return{pageView:o,api:n,setMetaData:a,status:i,setStatus:r}}(jQuery),socialShares=function(e,t,n){function i(e,t){return t||(t=0),o(e,t),a(e,t),window.socialSharesData}function o(e,t){return r({element:{id:t,type:e}},"info")}function a(e,t){return d("busy"),s({element_type:e,element_id:t},function(e){if(e.success){var t={shares:e.data};d("free"),r(t,"update")}})}function r(t,n){return window.socialSharesData=e.extend(window.socialSharesData,t),n=n||"all",p.trigger("shares:"+n),window.socialSharesData}function s(n,i){var o=e.extend({action:"social_get_shares",element_type:"post",element_id:0},n),a={data:o};return t.api(a,i)}function c(){return window.socialSharesData}function u(e,t){n.ios()||(t.preventDefault(),l(e))}function l(e){var t=window.open(e,"name","height=500,width=550");window.focus&&t.focus()}function d(e){"busy"==e?p.addClass("is-busy"):"free"==e&&p.removeClass("is-busy")}function f(n,i){var o=e.extend({action:"social_save_intent",service_type:"",element_type:"post",element_id:0},n);return args={type:"POST",data:o},t.api(args,i)}var p=e("#social-shares");return{addIntent:f,getShares:s,update:i,popup:u,getCacheShares:c,updateGlobalObject:r}}(jQuery,dynamicData,device);jQuery(function(e){var t=e(".social__item"),n=e("#social-shares");t.find("a").on(eventtype,function(t){var n=e(this),i=n.closest("li").data("service"),o=n.attr("href");-1==o.indexOf("mailto")&&socialShares.popup(o,t),socialShares.addIntent({service_type:i,element_type:window.socialSharesData.element.type,element_id:window.socialSharesData.element.id||0},function(e){e.success&&socialShares.updateGlobalObject({shares:e.data})})}),n.on("shares:update",function(){var t=socialShares.getCacheShares().shares;e(this).find("li").each(function(){var n=e(this),i=n.data("service"),o=n.find("a");"total"==i?(n.find(".social-counter__number").text(t[i]),t[i]>99?n.removeClass("is-hidden"):n.addClass("is-hidden")):o.tooltipster("content",t[i])})}),e(window).on("meta:changed",function(t,i,o){n.find("li").each(function(){var t=e(this),n=t.find("a"),a=t.data("service")||null,r=n.data("pattern"),s=i||window.location.href,c=o||"Typeform blog",u=r?r.replace("{url}",s):"";"twitter"==a?u+="&text="+encodeURIComponent(c):"email"==a&&(u+="&subject"+encodeURIComponent(c)),n.attr("href",u)})})});var sidebarMenu=function(e){function t(t,n){a=t,r=e("body"),e("."+d).mCustomScrollbar(n)}function n(e){a.removeClass(s),r.removeClass(c),r.unbind(u),"function"==typeof e&&e()}function i(e){a.className=l,r.hasClass(c)?r.trigger(u):(setTimeout(function(){a.addClass(s),r.addClass(c),"function"==typeof e&&e()},25),o())}function o(){r.bind(u,function(e){hasParentClass(e.target,d)||n()})}var a,r,s="st-menu-open",c="is-menu-shown",u="click.menu",l="st-container",d="st-menu";return{close:n,open:i,init:t}}(jQuery),subscribeBar=function(e,t){function n(e,t){return h=e,v=t,f(),h}function i(){return b}function o(e,t,n){return n||(n=c),window.dataLayer&&window.dataLayer.push({EventCategory:"Blog",EventAction:"BlogNewsletterSubscribe",EventLabel:t}),a(e,t,n)}function a(e,n,i){return r(),t.api({data:{action:"subscribe_to_list",email:e,category:n||"all"},type:"POST",complete:s,success:i})}function r(){h.removeClass(b.error+" "+b.success).addClass(b.loading),h.find(".subscription__submit").text(y.loading)}function s(){h.removeClass(b.loading)}function c(e){e.success?u(e):l(e)}function u(e){h.addClass(b.success),d(y.success),m()}function l(e){h.addClass(b.error),d(y.error)}function d(e){v.find("p").text(e)}function f(){h.find("input").focus()}function p(e){w.val(e)}function m(){setTimeout(function(){e(".footer--social, .subscription").addClass(b.done)},4e3)}function g(e,t,n,i){e.addClass(b.loading),o(n,i,function(n){e.removeClass(b.loading),n.success?e.closest(t).addClass(b.success):e.addClass(b.error)})}var h,v,w=e("#subscribe-category"),b={success:"is-success",error:"is-error",loading:"is-loading",done:"is-subscribed",busy:"is-busy"},y={success:"Thanks! You're on the list, friend.",error:"Sorry there was an error",duplicated:"Looks like you're already subscribed, friend.",loading:"Subscribing..."};return{init:n,subscribeUser:o,updateCategory:p,getClasses:i,subscribeWithSecondaryBar:g}}(jQuery,dynamicData);jQuery(function(e){var t=e("#subscribe-bar");subscribeBar.init(t,e(".subscription__message")),t.find("form").on("submit",function(t){t.preventDefault();var n=e(this),i=n.find("#subscribe-email").val(),o=n.find("#subscribe-category").val();subscribeBar.subscribeUser(i,o)}),e("#subscribe-secondary").on("submit",function(t){t.preventDefault();var n=e(this),i=n.find("#subscription-email").val(),o=n.find("#subscription-category").val();subscribeBar.subscribeWithSecondaryBar(n,".subscribe__form-container",i,o)})}),window.slider=function(e,t,n,i){function o(e){T=e,r(),v(),c()}function a(e){k=e,B.removeClass(O.navigationIsLoading),u()}function r(){L.width()>=768?(L.off("resize.lazyLoad"),H.find(".post__header").each(function(){var t=e(this),n=t.data("background"),i=new Image;i.src=n,i.onload=function(e){s(t.find(".post__background--default"),this.src),t.removeClass(O.preview)}})):H.find(".post__background").removeClass(O.preview)}function s(e,t){return e.css({backgroundImage:"url("+t+")"})}function c(){L.on("resize.lazyLoad",r)}function u(){v(),w(),y()}function l(e,t){var n=T.find(t).eq(e.item.index),i=n.data("icons-color");return{item:n,color:n.data("color"),iconsColor:i||"#333",id:n.data("id"),palette:n.data("palette")}}function d(e,n){var i=p(e);return t.api(i,n)}function f(){return P}function p(e){return{data:{id:e||0,action:"load_post_content"}}}function m(e){Q.html(e.content),A.html(e.relatedPosts)}function g(t,n){var i="#262627";"negative"===n&&(i="#FFFF"),e(".top-icon").attr("fill",i),window.onionHeader.setPalette(n),e("body, .main article.post").removeClass(function(e,t){return(t.match(/(^|\s)category-\S+/g)||[]).join(" ")}).addClass(t)}function h(e){t.pageView(e),t.setMetaData(e),n.update("post",e.id),i.updateCategory(e.category)}function v(){e(E).find(".owl-nav__link").on(M,function(t){t.preventDefault(),"#prev"===e(this).attr("href")?T.trigger("prev.owl"):T.trigger("next.owl")})}function w(){e(document).keydown(b)}function b(e){var t=e.which,n=S();return!(t in z)||z[t](n)}function y(){k.find(".nav__link").on(M,function(t){var n=e(this).closest(".owl-item"),i=n.index();return n.hasClass("active")?(C(),!0):(_(k,i),!1)}),e(".js-close-nav").on(M,function(e){e.preventDefault(),C()})}function _(e,t){e.trigger("to.owl.carousel",[t,300,!0])}function C(){B.removeClass(O.showNavigation)}function S(){return B.hasClass(O.showNavigation)?k:T}function x(e){var t=e.item.index;t>0?(I(t-1,N),j(N)):D(N),t<e.item.count-1?(I(t+1,V),j(V)):D(V)}function D(e){e.closest(R).addClass(O.disabled)}function j(e){e.closest(R).removeClass(O.disabled)}function I(e,t){var n=H.eq(e),i=n.find(".post__title").text(),o=t.find(".owl-nav__text"),a=n.find(".post__header").data("thumbnail"),r=t.find(".owl-nav__image");o.text(i),r.attr("src",a)}var T,k,M=window.eventtype||window.getEventType(),P=!1,B=e("body"),Q=e(".post__content"),A=e(".related-items"),H=e(".slider__item"),L=e(window),E=".owl-nav",N=e(".owl-prev",E).find(".owl-nav__link"),V=e(".owl-next",E).find(".owl-nav__link"),R=".owl-nav__block",z={13:function(e){if(e.is(k)){var t=e.find(".owl-item.active .nav__link");window.location=t.attr("href"),setTimeout(function(){C()},1)}},27:function(e){C()},37:function(e){e.trigger("prev.owl")},39:function(e){e.trigger("next.owl")}},O={disabled:"is-disabled",showNavigation:"slider-nav-open",preview:"is-preview",navigationIsLoading:"navigation-is-loading"};return{init:o,initSubNav:a,getItemData:l,loadPost:d,setContent:m,changeColors:g,setDynamicData:h,busy:f,updateNav:x}}(jQuery,dynamicData,socialShares,subscribeBar);var scrollManager=function(e,t,n){function i(){D=e(".post__container"),s(),o()}function o(){a(),r()}function a(){M.on("resize",s)}function r(){M.on("scroll",C(function(){var e=w();e!==P&&(P=e,M.trigger("article:inView",[P]))}))}function s(){S=M.width(),x=M.height(),j=D.offset(),T=e(".js-footer").height(),k=e(".js-main-header").outerHeight(!0)||x,I=e(document).height()}function c(e){var t=j.top;S<=screenSizes.smallMedium&&(t-=73),S>=e&&u(t)}function u(t,n){e("body, html").animate({scrollTop:t},n||500,"easeInOutQuad")}function l(e,t,n){var i=document.getElementById(e);if(i){var o=i.getBoundingClientRect();return n=t?d(o.top,n):null,u(o.top,n)}}function d(e,t){var n=M.scrollTop();return Math.abs(e-n)*(t||.3)}function f(e){return!t.status().url&&h()>e}function p(e){t.setStatus("url",!0),n.loadPost(e,function(e){t.pageView(e)})}function m(e){return!t.status().meta&&h()>e}function g(e){t.setStatus("meta",!0),n.loadPost(e,function(e){t.setMetaData(e)})}function h(){return M.scrollTop()}function v(){return w()}function w(){return h()+x<I-T&&h()>k}function b(){var e=[].slice.apply(document.querySelectorAll("article.post"));if(1===e.length)return e[0];var t=e.map(function(e){var t=e.getBoundingClientRect();return t.bottom>=0&&t.right>=0&&t.top<=x&&t.left<=S}),n=t.lastIndexOf(!0);return-1!==n?e[n]:e[0]}function y(){return h()>x}function _(){return S}function C(e,t,n){var i;return function(){var o=this,a=arguments,r=function(){i=null,n||e.apply(o,a)},s=n&&!i;clearTimeout(i),i=setTimeout(r,t),s&&e.apply(o,a)}}var S,x,D,j,I,T,k,M=e(window),P=!1;return{init:i,update:s,scrollToContent:c,scrollTo:u,scrollToElementId:l,isReadingArticle:m,isValidForPageView:f,setVirtualPageView:p,setDynamicMeta:g,showSubscriptionBar:v,isBelowSlider:y,windowWidth:_,getCurrentArticle:b,windowHeight:x,viewportInArticle:w,debounce:C}}(jQuery,dynamicData,slider),contentPlugins=function(e,t){function n(){o();var n=e(".post__content");n.off(eventtype,a),n.on(eventtype,a,function(n){var o,a=e(this);o=a.is("blockquote")?a.text():a.find(".component__content").text();var r=a.data("url")||location.href,s=a.data("hashtags")||"",c=i(r,o,s);t.ios()?a.is("blockquote")||e(this).attr("href",c):(n.preventDefault(),window.open(c,"_blank","width=575,height=270"))})}function i(e,t,n){var i=140-e.length+4,o="";return t=t.replace(/\s\s+/g," ").trim(),t=t.length>=i?t.substring(0,i)+"…":t,o="https://twitter.com/intent/tweet?url="+encodeURIComponent(e)+"&text="+encodeURIComponent(t),n&&(o+="&hashtags=",o+=encodeURIComponent(n)),o}function o(){if(window.typeformEmbed)for(var e=document.querySelectorAll(".typeform-widget"),t=0,n=e.length;t<n;++t)window.typeformEmbed.makeWidget(e[t],e[t].getAttribute("data-url"))}var a="a.statement__link, .pull-quote--tweeteable .component__link";return n(),{update:n}}(jQuery,device),progressBar=function(e){function t(e){c=e,n(),o()}function n(){r=d.height(),s=e(document).height(),u=s-r,c.attr("max",u)}function i(e){c.attr("value",e)}function o(){d.off("scroll.progress").on("scroll.progress",function(){l=d.scrollTop(),i(l)}).on("resize.progress",function(){n()})}function a(){d.off("scroll.progress resize.progress")}var r,s,c,u,l,d=e(window);return{init:t,update:n,setValue:i,disable:a}}(jQuery),infiniteScroll=function(e,t,n){var i,o=!1,a=e(window),r=[],s=function(){return r.find(function(e){return e.isCurrent})},c=function(e){return r.find(function(t){return t.index===e})},u=function(e){r=r.map(function(n){return n.isCurrent=n.index===e,n.$menuItem.toggleClass("is-active",n.isCurrent),n.isCurrent&&(t.pageView(n),t.setMetaData(n,!0),socialShares.update("post",n.id)),n})},l=function(){var e=window.pageYOffset,t=window.innerHeight,n=document.body.offsetHeight;return Math.max(n-(e+t),0)},d=function(){var e=n.getCurrentArticle(),t=parseInt(e.className.match(/js-csgc-(\d)/)[1]);e&&t!==s().index&&u(t)},f=function(){i=document.querySelectorAll(".chapter-navigation__item"),r=[].slice.call(i).reduce(function(t,n){return t.push({id:n.dataset.id,title:n.getAttribute("title"),index:parseInt(n.dataset.index),url:n.querySelector("a").href,$menuItem:e(n),isCurrent:n.classList.contains("is-active")}),t},[]),h()},p=function(){return $loading=e("<div/>").addClass("loading-epic").html("<div class=epic-spinner></div>"),$loading.insertAfter(e(".container__main")),$loading.hide(),$loading},m=function(t){t.show(),e(".epic-footer, .footer").hide()},g=function(t){t.hide(),e(".epic-footer, .footer").show()},h=function(){var t=p();a.on("scroll",n.debounce(d,50)),a.on("scroll.infiniteScroll",n.debounce(function(i){if(l()<=3e3&&!o){o=!0,m(t);var u=s(),d=c(u.index+1);if(!d)return void g(t);d.index===r[r.length-1].index&&a.off("scroll.infiniteScroll"),e.get(d.url,function(i){var a=e(i).find("article.post");e("article.post.js-csgc-"+u.index).after(a),g(t),n.update(),progressBar.update(),contentPlugins.update(),o=!1})}},50))};return{init:f}}(jQuery,dynamicData,scrollManager);jQuery(function(e){var t=e("body"),n=e("html"),i=e(".header"),o=e(".js-slider--main .slider__item").first().find(".post__header"),a=e(".footer--social");scrollManager.init(),progressBar.init(e(".progress-bar")),t.removeClass("loading").addClass("loaded").addClass(o.data("color")),"touchstart"===eventtype?n.addClass("is-touch"):n.addClass("is-non-touch"),pusherHammer.on("swipeup",function(){i.hasClass("is-down")||i.addClass("is-down").removeClass("is-up")}),pusherHammer.on("swipedown",function(){i.hasClass("is-up")||i.addClass("is-up").removeClass("is-down")}),sidebarMenu.init(e("#st-container"),scrollbarConfig),e(".js-menu-trigger").on(eventtype,function(e){return sidebarMenu.open(function(){pusherHammer.set({touchAction:"none"})}),!1}),e(".st-menu__close").on(eventtype,function(e){e.preventDefault(),sidebarMenu.close(function(){pusherHammer.set({touchAction:"auto"})})});var r=e(".js-slider--main"),s=e(".js-slider");slider.init(r),r.owlCarousel({items:1,nav:!0,dots:!1,navText:["",""]}).on("changed.owl.carousel",function(e){var t=slider.getItemData(e,".js-slide");s.addClass("is-loading"),slider.loadPost(t.id).then(function(n){slider.setContent(n),slider.changeColors(t.color,t.palette),slider.setDynamicData(n),slider.updateNav(e),t.item.addClass("is-active"),s.removeClass("is-loading"),contentPlugins.update()})}),e(".post__header").find(".post__duration").on(eventtype,function(){scrollManager.scrollToContent(0)}),e(window).on("scroll",scrollManager.debounce(function(){scrollManager.showSubscriptionBar()?a.addClass("is-visible"):a.removeClass("is-visible"),scrollManager.isBelowSlider()?i.addClass("is-below-slider"):i.removeClass("is-below-slider")})),e(".social__item a").tooltipster({theme:"tooltipster-typeform",minWidth:50}),e(".related-item__inner").click(function(){var e=this.getAttribute("data-href");window.location.href=e})});